sCnnODBC  Driver={Microsoft Access Driver (*.mdb)};Dbq=
sCnnODBCjet Provider=Microsoft.Jet.OLEDB.4.0;Data Source=
sCnnODBCxls Driver={Microsoft Excel Driver (*.xls)};DefaultDir=C:\\c_portab\\
delTabl delete * from
selExcpList select kyfld,excep from _excep_list order by kyfld,excep
isrExcpLine insert into excep_lines (kyfld,exstr) values(?,?)
selExcpLine select kyfld,exstr from excep_lines where kyfld=?
selXlsBomItm  select seqno,matnr,idnrk as match from ? where postp in ('L','N') union select seqno,matnr,doknr as match from ? where postp='D' order by seqno,match
updXlsBomItm  update ? set match=?,exstr=? where seqno=?
isrLclBomItm  insert into _lst#_bomitm_lcl select * from _lst#_bomitm_txt
selLclBomItm  select seqno,matnr,idnrk as match from _lst#_bomitm_lcl where postp in ('L','N') union select seqno,matnr,doknr as match from _lst#_bomitm_lcl where postp='D' order by seqno,match
updLclBomItm  update _lst#_bomitm_lcl set match=? where seqno=?
selBomItem1nr select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst1_bomitm_xls group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem2nr select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst2_bomitm_xls group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem1r1 select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst1_bomitm_xls where (beskz<>'F' or (beskz='F' and sobsl='30')) and (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem2r1 select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst2_bomitm_xls where (beskz<>'F' or (beskz='F' and sobsl='30')) and (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem1r2 select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst1_bomitm_xls where (beskz in ('E','X') or (beskz='F' and sobsl='30')) and (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem2r2 select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst2_bomitm_xls where (beskz in ('E','X') or (beskz='F' and sobsl='30')) and (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem1tr select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst1_bomitm_xls where (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
selBomItem2tr select distinct(systm+werks+matnr+stlal) as bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,'X' as wtbom from _lst2_bomitm_xls where (mtart not in ('VERP','HIBE','LEIH','IBAU')) and stlal in ('1','01') group by systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl
isrBomList1 insert into bomlist1 (bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,wtbom,matnb) values(?,?,?,?,?,?,?,?,?,?,?)
isrBomList2 insert into bomlist2 (bomid,systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,wtbom,matnb) values(?,?,?,?,?,?,?,?,?,?,?)
isrBomMtchi insert into bomhdr_match select * from bomlst_match
isrBomMtch1 insert into bomhdr_match select a.systm as systb,a.werks as werkb,a.matnb as matnb,a.stlal as stlab,'InList1_InList2'    as idenb,a.systm as systm1,a.werks as werks1,a.matnr as matnr1,a.maktx as maktx1,a.stlal as stlal1,a.mtart as mtart1,a.beskz as beskz1,a.sobsl as sobsl1,a.wtbom as wtbom1,b.systm as systm2,b.werks as werks2,b.matnr as matnr2,b.maktx as maktx2,b.stlal as stlal2,b.mtart as mtart2,b.beskz as beskz2,b.sobsl as sobsl2,b.wtbom as wtbom2 from bomlist1 as a inner join bomlist2 as b on a.stlal=b.stlal and a.matnb=b.matnb
isrBomMtch2 insert into bomhdr_match select a.systm as systb,a.werks as werkb,a.matnb as matnb,a.stlal as stlab,'InList1_NotInList2' as idenb,a.systm as systm1,a.werks as werks1,a.matnr as matnr1,a.maktx as maktx1,a.stlal as stlal1,a.mtart as mtart1,a.beskz as beskz1,a.sobsl as sobsl1,a.wtbom as wtbom1,null    as systm2,null    as werks2,null    as matnr2,null    as maktx2,null    as stlal2,null    as mtart2,null    as beskz2,null    as sobsl2,null    as wtbom2 from bomlist1 as a left  join bomlist2 as b on a.stlal=b.stlal and a.matnb=b.matnb where b.matnr is null
isrBomMtch3 insert into bomhdr_match select b.systm as systb,b.werks as werkb,b.matnb as matnb,b.stlal as stlab,'NotInList1_InList2' as idenb,null    as systm1,null    as werks1,null    as matnr1,null    as maktx1,null    as stlal1,null    as mtart1,null    as beskz1,null    as sobsl1,null    as wtbom1,b.systm as systm2,b.werks as werks2,b.matnr as matnr2,b.maktx as maktx2,b.stlal as stlal2,b.mtart as mtart2,b.beskz as beskz2,b.sobsl as sobsl2,b.wtbom as wtbom2 from bomlist2 as b left  join bomlist1 as a on b.stlal=a.stlal and b.matnb=a.matnb where a.matnr is null;
isrBomMtche insert into bomhdr_match select * from extern_bomlst_match
selBomMtch  select matnb,stlab,idenb,systm1,werks1,matnr1,maktx1,stlal1,mtart1,beskz1,sobsl1,wtbom1,systm2,werks2,matnr2,maktx2,stlal2,mtart2,beskz2,sobsl2,wtbom2 from bomhdr_matchs
isrBomHdrComp insert into bomhdr_comp (seqnh,gbcod,bucod,ident,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,wtbom1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,wtbom2,bomdf,items,commo,exclu,commp,comeq,comdf,cmndp,tfldd,mrate) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
selMtrlItm1nr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') order by match
selMtrlItm2nr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') order by match
selMtrlItm1tr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') and cmtart not in ('VERP','HIBE','LEIH','IBAU') order by match,posnr
selMtrlItm2tr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') and cmtart not in ('VERP','HIBE','LEIH','IBAU') order by match,posnr
selDocuItm1 select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
selDocuItm2 select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
selMtDcItm1nr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L')                                                                union select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
selMtDcItm2nr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L')                                                                union select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
selMtDcItm1tr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') and cmtart not in ('VERP','HIBE','LEIH','IBAU') order by match union select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst1_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
selMtDcItm2tr select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,         idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp in ('N','L') and cmtart not in ('VERP','HIBE','LEIH','IBAU') order by match union select systm,werks,matnr,maktx,stlal,mtart,beskz,sobsl,posnr,postp,(doknr) as idnrk,cmaktx,cmtart,cbeskz,csobsl,menge,meins,alpos,alpgr,alprf,alpst,ewahr,sanko,sanfe,sanka,dokar,doknr,dokvr,doktl,match,exstr from _lst2_bomitm_xls where systm=? and werks=? and matnr=? and stlal=? and postp = 'D' order by match
isrBomItmWork insert into bomitm_work (seqnw,gbcod,bucod,ident,ibom1,ibom2,ifldd,itmdf,items,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,posnrd1,posnr1,postpd1,postp1,idnrkd1,idnrk1,cmaktd1,cmakt1,cmtard1,cmtar1,cbeskd1,cbesk1,csobsd1,csobs1,menged1,menge1,meinsd1,meins1,alposd1,alpos1,alpgrd1,alpgr1,alprfd1,alprf1,alpstd1,alpst1,ewahrd1,ewahr1,sankod1,sanko1,sanfed1,sanfe1,sankad1,sanka1,dokard1,dokar1,doknrd1,doknr1,dokvrd1,dokvr1,doktld1,doktl1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,posnrd2,posnr2,postpd2,postp2,idnrkd2,idnrk2,cmaktd2,cmakt2,cmtard2,cmtar2,cbeskd2,cbesk2,csobsd2,csobs2,menged2,menge2,meinsd2,meins2,alposd2,alpos2,alpgrd2,alpgr2,alprfd2,alprf2,alpstd2,alpst2,ewahrd2,ewahr2,sankod2,sanko2,sanfed2,sanfe2,sankad2,sanka2,dokard2,dokar2,doknrd2,doknr2,dokvrd2,dokvr2,doktld2,doktl2,seqnh,posnr)       values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
selBomItmWork select                   seqnw,gbcod,bucod,ident,ibom1,ibom2,ifldd,itmdf,items,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,posnrd1,posnr1,postpd1,postp1,idnrkd1,idnrk1,cmaktd1,cmakt1,cmtard1,cmtar1,cbeskd1,cbesk1,csobsd1,csobs1,menged1,menge1,meinsd1,meins1,alposd1,alpos1,alpgrd1,alpgr1,alprfd1,alprf1,alpstd1,alpst1,ewahrd1,ewahr1,sankod1,sanko1,sanfed1,sanfe1,sankad1,sanka1,dokard1,dokar1,doknrd1,doknr1,dokvrd1,dokvr1,doktld1,doktl1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,posnrd2,posnr2,postpd2,postp2,idnrkd2,idnrk2,cmaktd2,cmakt2,cmtard2,cmtar2,cbeskd2,cbesk2,csobsd2,csobs2,menged2,menge2,meinsd2,meins2,alposd2,alpos2,alpgrd2,alpgr2,alprfd2,alprf2,alpstd2,alpst2,ewahrd2,ewahr2,sankod2,sanko2,sanfed2,sanfe2,sankad2,sanka2,dokard2,dokar2,doknrd2,doknr2,dokvrd2,dokvr2,doktld2,doktl2,seqnh,posnr from bomitm_work order by seqnh, posnr
isrBomItmComp insert into bomitm_comp (seqni,gbcod,bucod,ident,ibom1,ibom2,ifldd,itmdf,nline,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,posnrd1,posnr1,postpd1,postp1,idnrkd1,idnrk1,cmaktd1,cmakt1,cmtard1,cmtar1,cbeskd1,cbesk1,csobsd1,csobs1,menged1,menge1,meinsd1,meins1,alposd1,alpos1,alpgrd1,alpgr1,alprfd1,alprf1,alpstd1,alpst1,ewahrd1,ewahr1,sankod1,sanko1,sanfed1,sanfe1,sankad1,sanka1,dokard1,dokar1,doknrd1,doknr1,dokvrd1,dokvr1,doktld1,doktl1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,posnrd2,posnr2,postpd2,postp2,idnrkd2,idnrk2,cmaktd2,cmakt2,cmtard2,cmtar2,cbeskd2,cbesk2,csobsd2,csobs2,menged2,menge2,meinsd2,meins2,alposd2,alpos2,alpgrd2,alpgr2,alprfd2,alprf2,alpstd2,alpst2,ewahrd2,ewahr2,sankod2,sanko2,sanfed2,sanfe2,sankad2,sanka2,dokard2,dokar2,doknrd2,doknr2,dokvrd2,dokvr2,doktld2,doktl2,seqnh,posnr,seqnw) values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)
bomlst_match  select a.systm as systb,a.werks as werkb,a.matnb as matnb,a.stlal as stlab,'InList1_InList2' as idenb,a.systm as systm1, a.werks as werks1,a.matnr as matnr1,a.maktx as maktx1,a.stlal as stlal1,a.mtart as mtart1,a.beskz as beskz1,a.sobsl as sobsl1,a.wtbom as wtbom1,b.systm as systm2,b.werks as werks2,b.matnr as matnr2,b.maktx as maktx2,b.stlal as stlal2,b.mtart as mtart2,b.beskz as beskz2,b.sobsl as sobsl2,b.wtbom as wtbom2 from bomlist1 as a inner join bomlist2 as b on a.stlal=b.stlal and a.matnb=b.matnb union select a.systm as systb,a.werks as werkb,a.matnb as matnb,a.stlal as stlab, 'InList1_NotInList2' as idenb,a.systm as systm1,a.werks as werks1,a.matnr as matnr1,a.maktx as maktx1,a.stlal as stlal1,a.mtart as mtart1,a.beskz as beskz1,a.sobsl as sobsl1,a.wtbom as wtbom1,null as systm2,null as werks2,null as matnr2,null as maktx2,null as stlal2,null as mtart2,null as beskz2,null as sobsl2,null as wtbom2 from bomlist1 as a left  join bomlist2 as b on a.stlal=b.stlal and a.matnb=b.matnb where b.matnr is null union select b.systm as systb,b.werks as werkb,b.matnb as matnb,b.stlal as stlab,'NotInList1_InList2' as idenb,null as systm1,null as werks1,null as matnr1,null as maktx1,null as stlal1,null as mtart1,null as beskz1,null as sobsl1,null as wtbom1,b.systm as systm2,b.werks as werks2,b.matnr as matnr2,b.maktx as maktx2,b.stlal as stlal2,b.mtart as mtart2,b.beskz as beskz2,b.sobsl as sobsl2,b.wtbom as wtbom2 from bomlist2 as b left  join bomlist1 as a on b.stlal=a.stlal and b.matnb=a.matnb where a.matnr is null;
_output_bomhdr_comp select seqnh,gbcod,bucod,ident,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,wtbom1,wtbom2,bomdf,items,commo,exclu,commp,comeq,comdf,cmndp,comdf,mrate from bomhdr_comp order by seqnh
_output_bomitm_comp select seqni,gbcod,bucod,dent,ifldd,itmdf,nline,systm1,matnr1,maktx1,werks1,stlal1,mtart1,beskz1,sobsl1,posnr1,postpd1,postp1,idnrk1,cmakt1,cmtar1,cbesk1,csobs1,menged1,menge1,meinsd1,meins1,alposd1,alpos1,alpgrd1,alpgr1,alprfd1,alprf1,alpstd1,alpst1,ewahrd1,ewahr1,sankod1,sanko1,sanfed1,sanfe1,sankad1,sanka1,dokard1,dokar1,dokvrd1,dokvr1,doktld1,doktl1,systm2,matnr2,maktx2,werks2,stlal2,mtart2,beskz2,sobsl2,posnr2,postpd2,postp2,idnrk2,cmakt2,cmtar2,cbesk2,csobs2,menged2,menge2,meinsd2,meins2,alposd2,alpos2,alpgrd2,alpgr2,alprfd2,alprf2,alpstd2,alpst2,ewahrd2,ewahr2,sankod2,sanko2,sanfed2,sanfe2,sankad2,sanka2,dokard2,dokar2,dokvrd2,dokvr2,doktld2,doktl2 from bomitm_comp order by seqni
selBomItem1 TBD
selBomItem2 TBD
selMtrlItm1 TBD
selMtrlItm2 TBD
selMtDcItm1 TBD
selMtDcItm2 TBD
